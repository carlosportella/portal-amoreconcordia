
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Cadastro de Usuários</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/estilos.css') }}">
</head>
<body>
    <div class="main-container">
        <h2>Cadastro de Usuários</h2>
        <form id="usuarioForm" method="POST" action="/salvar_usuario">
            <input type="hidden" name="modo" id="modo" value="novo">
            <input type="hidden" name="sim_original" id="sim_original" value="">
            <label>SIM: <input type="text" name="sim" id="sim" required></label><br>
            <label>Senha: <input type="password" name="senha" id="senha" required></label><br>
            <label>Nome: <input type="text" name="nome" id="nome" required></label><br>
            <label>Aniversário: <input type="date" name="aniversario" id="aniversario"></label><br>
            <label>Admin: <input type="checkbox" name="admin" id="admin" value="1"></label><br>
            <label>Emérito: <input type="checkbox" name="emerito" id="emerito" value="1"></label><br>
            <label>Remido: <input type="checkbox" name="remido" id="remido" value="1"></label><br>
            <label>Ativo: <input type="checkbox" name="ativo" id="ativo" value="1" checked></label><br>
            <label>Loja Base:
                <select name="lojabase" id="lojabase">
                    <option value="Aprendiz">Aprendiz</option>
                    <option value="Companheiro">Companheiro</option>
                    <option value="Mestre">Mestre</option>
                </select>
            </label><br>
            <label>Filosóficos:
                <select name="filosoficos" id="filosoficos">
                    {% for grau in range(1, 34) %}
                        <option value="Grau {{ grau }}">Grau {{ grau }}</option>
                    {% endfor %}
                </select>
            </label><br><br>
            <button type="submit" id="salvarBtn">Salvar</button>
        </form>

        <table class="table-users">
            <thead>
                <tr>
                    <th>SIM</th><th>Nome</th><th>Admin</th><th>Ativo</th><th>Ações</th>
                </tr>
            </thead>
            <tbody>
                {% for u in usuarios %}
                <tr>
                    <td>{{ u.sim }}</td>
                    <td>{{ u.nome }}</td>
                    <td>{{ 'Sim' if u.admin else 'Não' }}</td>
                    <td>{{ 'Sim' if u.ativo else 'Não' }}</td>
                    <td>
                        <button onclick="carregarUsuario('{{ u | tojson | safe }}')">Alterar</button>
                        <a href="/excluir_usuario/{{ u.sim }}">Excluir</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <script>
        function carregarUsuario(json) {
            const u = JSON.parse(json);
            document.getElementById('modo').value = 'editar';
            document.getElementById('sim_original').value = u.sim;
            document.getElementById('sim').value = u.sim;
            document.getElementById('senha').value = u.senha;
            document.getElementById('nome').value = u.nome;
            document.getElementById('admin').checked = u.admin == 1;
            document.getElementById('emerito').checked = u.emerito == 1;
            document.getElementById('remido').checked = u.remido == 1;
            document.getElementById('ativo').checked = u.ativo == 1;
            document.getElementById('aniversario').value = u.aniversario || '';
            document.getElementById('lojabase').value = u.lojabase || 'Aprendiz';
            document.getElementById('filosoficos').value = u.filosoficos || 'Grau 1';
        }
    </script>
</body>
</html>
